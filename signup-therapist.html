<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apply as Therapist - MindSpace</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #C9E4DE 0%, #A8D5BA 100%); min-height: 100vh; color: #2C3E50; }
        .navbar { background-color: rgba(255, 255, 255, 0.95); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); position: fixed; top: 0; width: 100%; z-index: 1000; backdrop-filter: blur(10px); }
        .nav-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; height: 80px; }
        .logo { font-size: 1.8rem; font-weight: 700; color: #5A9B8E; text-decoration: none; display: flex; align-items: center; gap: 10px; }
        .logo-icon { font-size: 1.5rem; }
        .nav-links { display: flex; list-style: none; gap: 30px; align-items: center; }
        .nav-links a { text-decoration: none; color: #4B5563; font-weight: 500; font-size: 0.95rem; transition: all 0.3s ease; padding: 8px 0; position: relative; }
        .nav-links a:hover { color: #5A9B8E; }
        .btn-nav-login { background: linear-gradient(135deg, #5A9B8E 0%, #4A8B7E 100%); color: white; padding: 10px 24px; border-radius: 50px; font-weight: 600; font-size: 0.95rem; transition: all 0.3s ease; }
        .btn-nav-login:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(90, 155, 142, 0.3); }
        .main-content { padding: 120px 20px 60px; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .application-container { width: 100%; max-width: 1000px; display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: start; }
        @media (max-width: 900px) { .application-container { grid-template-columns: 1fr; max-width: 600px; } }
        .application-info { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.08); border: 1px solid rgba(229, 231, 235, 0.8); }
        .application-info h2 { font-size: 2.2rem; color: #2C3E50; margin-bottom: 20px; font-weight: 700; background: linear-gradient(135deg, #2C3E50 0%, #5A9B8E 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .application-info p { color: #4B5563; line-height: 1.6; margin-bottom: 25px; font-size: 1.05rem; }
        .benefits-list { margin: 30px 0; display: flex; flex-direction: column; gap: 20px; }
        .benefit-item { display: flex; align-items: flex-start; gap: 15px; }
        .benefit-icon { width: 40px; height: 40px; background: rgba(90, 155, 142, 0.1); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: #5A9B8E; flex-shrink: 0; }
        .benefit-text h4 { color: #2C3E50; font-size: 1.1rem; margin-bottom: 5px; font-weight: 600; }
        .benefit-text p { color: #6B7280; font-size: 0.95rem; margin: 0; }
        .process-timeline { background: #F5F9F8; padding: 25px; border-radius: 15px; margin-top: 40px; border-left: 4px solid #5A9B8E; }
        .process-timeline h3 { color: #2C3E50; margin-bottom: 20px; font-size: 1.3rem; font-weight: 600; }
        .process-step { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid rgba(229, 231, 235, 0.8); }
        .process-step:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
        .step-number { width: 36px; height: 36px; background: linear-gradient(135deg, #5A9B8E 0%, #4A8B7E 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0; }
        .step-content h4 { color: #2C3E50; font-size: 1rem; margin-bottom: 5px; font-weight: 600; }
        .step-content p { color: #6B7280; font-size: 0.9rem; margin: 0; }
        .application-form-container { background: white; padding: 50px 40px; border-radius: 20px; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.08); border: 1px solid rgba(229, 231, 235, 0.8); position: relative; overflow: hidden; }
        .application-form-container::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #5A9B8E 0%, #A8D5BA 100%); }
        .form-header { text-align: center; margin-bottom: 40px; }
        .form-header h1 { font-size: 2.5rem; color: #2C3E50; margin-bottom: 10px; font-weight: 700; }
        .form-header p { color: #6B7280; font-size: 1.1rem; }
        #therapistForm { display: flex; flex-direction: column; gap: 25px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        @media (max-width: 600px) { .form-row { grid-template-columns: 1fr; gap: 20px; } }
        .form-group { display: flex; flex-direction: column; gap: 8px; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-group label { display: flex; align-items: center; gap: 8px; color: #2C3E50; font-weight: 600; font-size: 0.95rem; }
        .label-icon { color: #5A9B8E; font-size: 1rem; }
        .required-mark { color: #EF4444; margin-left: 4px; }
        .form-input, .form-textarea, .form-select { width: 100%; padding: 16px 20px; border: 2px solid #E5E7EB; border-radius: 12px; font-size: 1rem; transition: all 0.3s ease; background: #F9FAFB; color: #2C3E50; font-family: inherit; }
        .form-textarea { resize: vertical; min-height: 120px; line-height: 1.5; }
        .form-select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%235A9B8E' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a 1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 20px center; background-size: 16px; padding-right: 50px; }
        .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: #5A9B8E; background: white; box-shadow: 0 0 0 4px rgba(90, 155, 142, 0.1); }
        .password-wrapper { position: relative; }
        .password-toggle { position: absolute; right: 16px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #6B7280; cursor: pointer; font-size: 1.1rem; padding: 4px; }
        .password-toggle:hover { color: #5A9B8E; }
        .input-hint { color: #6B7280; font-size: 0.85rem; margin-top: 4px; font-style: italic; }
        .error-message { color: #EF4444; font-size: 0.875rem; margin-top: 5px; display: none; }
        .btn-submit { width: 100%; padding: 18px; background: linear-gradient(135deg, #5A9B8E 0%, #4A8B7E 100%); color: white; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; margin-top: 20px; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-submit:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(90, 155, 142, 0.3); }
        .btn-submit:disabled { background: #9CA3AF; cursor: not-allowed; transform: none; box-shadow: none; }
        .btn-submit .loading-spinner { display: inline-block; width: 20px; height: 20px; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: white; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .form-footer { text-align: center; margin-top: 30px; padding-top: 25px; border-top: 1px solid #E5E7EB; }
        .form-footer p { color: #6B7280; font-size: 0.95rem; margin-bottom: 15px; }
        .form-footer a { color: #5A9B8E; text-decoration: none; font-weight: 600; transition: all 0.3s ease; }
        .form-footer a:hover { color: #4A8B7E; text-decoration: underline; }
        .requirements-panel { background: #F5F9F8; padding: 25px; border-radius: 15px; margin-top: 30px; border-left: 4px solid #5A9B8E; }
        .requirements-panel h4 { color: #2C3E50; margin-bottom: 15px; font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .requirements-list { list-style: none; }
        .requirements-list li { color: #6B7280; font-size: 0.9rem; margin-bottom: 10px; padding-left: 25px; position: relative; }
        .requirements-list li::before { content: '‚úì'; position: absolute; left: 0; color: #5A9B8E; font-weight: bold; }
        .footer { background: rgba(255, 255, 255, 0.8); color: #2C3E50; padding: 30px 20px 20px; backdrop-filter: blur(10px); border-top: 1px solid rgba(229, 231, 235, 0.8); }
        .footer-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; }
        .footer-logo { font-size: 1.2rem; font-weight: 700; color: #5A9B8E; display: flex; align-items: center; gap: 8px; }
        .footer-links { display: flex; gap: 20px; list-style: none; }
        .footer-links a { color: #6B7280; text-decoration: none; font-size: 0.9rem; transition: color 0.3s ease; }
        .footer-links a:hover { color: #5A9B8E; }
        .footer-bottom { text-align: center; padding-top: 20px; margin-top: 20px; border-top: 1px solid rgba(229, 231, 235, 0.8); color: #9CA3AF; font-size: 0.85rem; max-width: 1200px; margin: 20px auto 0; }
        .menu-toggle { display: none; background: none; border: none; font-size: 1.5rem; color: #5A9B8E; cursor: pointer; }
        @media (max-width: 768px) {
            .menu-toggle { display: block; }
            .nav-links { display: none; position: absolute; top: 80px; left: 0; width: 100%; background: white; padding: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); flex-direction: column; gap: 20px; }
            .nav-links.active { display: flex; }
            .application-info, .application-form-container { padding: 30px 25px; }
            .form-header h1 { font-size: 2rem; }
        }
        @media (max-width: 480px) {
            .application-info h2 { font-size: 1.8rem; }
            .form-header h1 { font-size: 1.8rem; }
            .footer-container { flex-direction: column; text-align: center; gap: 15px; }
        }
        .alert { padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9rem; }
        .alert-success { background: #D4EDDA; color: #155724; border: 1px solid #C3E6CB; }
        .alert-error { background: #F8D7DA; color: #721C24; border: 1px solid #F5C6CB; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <span class="logo-icon">üß†</span>
                <span class="logo-text">MindSpace</span>
            </a>
            <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
            <ul class="nav-links" id="navLinks">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="how-it-works.html">How It Works</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="login.html" class="btn-nav-login">Login</a></li>
            </ul>
        </div>
    </nav>

    <main class="main-content">
        <div class="application-container">
            <div class="application-info">
                <h2>Join Our Network of Mental Health Professionals</h2>
                <p>At MindSpace, we're looking for passionate, licensed therapists to join our mission of making mental wellness accessible to everyone.</p>
                
                <div class="benefits-list">
                    <div class="benefit-item">
                        <div class="benefit-icon">üíº</div>
                        <div class="benefit-text">
                            <h4>Flexible Practice</h4>
                            <p>Set your own schedule and work from anywhere.</p>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <div class="benefit-icon">üí∞</div>
                        <div class="benefit-text">
                            <h4>Competitive Compensation</h4>
                            <p>Earn competitive rates with transparent pricing.</p>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <div class="benefit-icon">üõ°Ô∏è</div>
                        <div class="benefit-text">
                            <h4>Professional Support</h4>
                            <p>Access to our support team and secure platform.</p>
                        </div>
                    </div>
                </div>
                
                <div class="requirements-panel">
                    <h4><i class="fas fa-clipboard-check"></i> Application Requirements</h4>
                    <ul class="requirements-list">
                        <li>Valid license to practice therapy</li>
                        <li>Minimum 2 years of clinical experience</li>
                        <li>Professional liability insurance</li>
                        <li>Master's degree or higher in relevant field</li>
                    </ul>
                </div>
                
                <div class="process-timeline">
                    <h3>Application Process</h3>
                    <div class="process-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Submit Application</h4>
                            <p>Complete the form with your details.</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Document Verification</h4>
                            <p>We verify your licenses and qualifications.</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Platform Orientation</h4>
                            <p>Complete onboarding and training.</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Start Practicing</h4>
                            <p>Begin accepting clients!</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="application-form-container">
                <div class="form-header">
                    <h1>Therapist Application</h1>
                    <p>Complete the form below to join our network.</p>
                </div>

                <div id="alertMessage"></div>
                
                <form id="therapistForm" novalidate>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fullName">
                                <span class="label-icon">üë§</span>
                                Full Name
                                <span class="required-mark">*</span>
                            </label>
                            <input type="text" id="fullName" class="form-input" placeholder="Dr. John Doe" required>
                            <div class="error-message">Please enter your full name</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="email">
                                <span class="label-icon">üìß</span>
                                Email Address
                                <span class="required-mark">*</span>
                            </label>
                            <input type="email" id="email" class="form-input" placeholder="your.email@example.com" required>
                            <div class="error-message">Please enter a valid email</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone">
                                <span class="label-icon">üì±</span>
                                Phone Number
                                <span class="required-mark">*</span>
                            </label>
                            <input type="tel" id="phone" class="form-input" placeholder="+91 98765 43210" required>
                            <div class="error-message">Please enter phone number</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="birthday">
                                <span class="label-icon">üìÖ</span>
                                Date of Birth
                                <span class="required-mark">*</span>
                            </label>
                            <input type="date" id="birthday" class="form-input" required max="2008-01-27">
                            <div class="error-message">Please enter your date of birth</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="experience">
                                <span class="label-icon">üíº</span>
                                Years of Experience
                                <span class="required-mark">*</span>
                            </label>
                            <select id="experience" class="form-select" required>
                                <option value="">Select years</option>
                                <option value="1-2">1-2 years</option>
                                <option value="3-5">3-5 years</option>
                                <option value="6-10">6-10 years</option>
                                <option value="10+">10+ years</option>
                            </select>
                            <div class="error-message">Please select experience</div>
                        </div>

                        <div class="form-group">
                            <label for="specialization">
                                <span class="label-icon">üéØ</span>
                                Specialization
                                <span class="required-mark">*</span>
                            </label>
                            <input type="text" id="specialization" class="form-input" placeholder="e.g., Anxiety, Depression" required>
                            <div class="error-message">Please enter specialization</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="hourlyRate">
                                <span class="label-icon">üí∞</span>
                                Hourly Rate (‚Çπ)
                                <span class="required-mark">*</span>
                            </label>
                            <input type="number" id="hourlyRate" class="form-input" placeholder="500" min="200" max="10000" required>
                            <div class="input-hint">Your fee per session (‚Çπ200 - ‚Çπ10,000)</div>
                            <div class="error-message">Please enter a valid hourly rate</div>
                        </div>

                        <div class="form-group">
                            <label for="sessionDuration">
                                <span class="label-icon">‚è±Ô∏è</span>
                                Session Duration (minutes)
                            </label>
                            <select id="sessionDuration" class="form-select">
                                <option value="45">45 minutes</option>
                                <option value="60" selected>60 minutes</option>
                                <option value="90">90 minutes</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="qualifications">
                            <span class="label-icon">üéì</span>
                            Qualifications & Certifications
                            <span class="required-mark">*</span>
                        </label>
                        <textarea id="qualifications" class="form-textarea" placeholder="List your degrees and certifications" required rows="4"></textarea>
                        <div class="error-message">Please enter qualifications</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bio">
                            <span class="label-icon">üìù</span>
                            Professional Bio
                            <span class="required-mark">*</span>
                        </label>
                        <textarea id="bio" class="form-textarea" placeholder="Tell us about your therapeutic approach..." required rows="6"></textarea>
                        <div class="error-message">Please write a bio</div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="password">
                                <span class="label-icon">üîí</span>
                                Password
                                <span class="required-mark">*</span>
                            </label>
                            <div class="password-wrapper">
                                <input type="password" id="password" class="form-input" placeholder="Minimum 8 characters" minlength="8" required>
                                <button type="button" class="password-toggle" id="passwordToggle">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="error-message">Password must be 8+ characters</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword">
                                <span class="label-icon">üîí</span>
                                Confirm Password
                                <span class="required-mark">*</span>
                            </label>
                            <div class="password-wrapper">
                                <input type="password" id="confirmPassword" class="form-input" placeholder="Re-enter password" minlength="8" required>
                                <button type="button" class="password-toggle" id="confirmPasswordToggle">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="error-message">Passwords do not match</div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-submit" id="submitBtn">
                        <span id="btnText">Submit Application</span>
                        <div class="loading-spinner" id="loadingSpinner" style="display: none;"></div>
                    </button>
                </form>
                
                <div class="form-footer">
                    <p>Already have an account? <a href="login.html">Login here</a></p>
                    <p>Looking for therapy? <a href="signup-user.html">Sign up as a patient</a></p>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-logo">
                <span class="logo-icon">üß†</span>
                <span class="logo-text">MindSpace</span>
            </div>
            <ul class="footer-links">
                <li><a href="privacy.html">Privacy Policy</a></li>
                <li><a href="terms.html">Terms of Service</a></li>
                <li><a href="contact.html">Contact Us</a></li>
            </ul>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 MindSpace Healthcare Pvt. Ltd. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="app.js"></script>
    <script>
        // Get supabase client from app.js
        const supabaseClient = window.supabaseClient;
        
        function showAlert(message, type) {
            const alertDiv = document.getElementById('alertMessage');
            alertDiv.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
            setTimeout(() => { alertDiv.innerHTML = ''; }, 6000);
        }

        document.getElementById('passwordToggle').addEventListener('click', function() {
            const passwordInput = document.getElementById('password');
            const type = passwordInput.type === 'password' ? 'text' : 'password';
            passwordInput.type = type;
            this.querySelector('i').className = type === 'password' ? 'fas fa-eye' : 'fas fa-eye-slash';
        });

        document.getElementById('confirmPasswordToggle').addEventListener('click', function() {
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const type = confirmPasswordInput.type === 'password' ? 'text' : 'password';
            confirmPasswordInput.type = type;
            this.querySelector('i').className = type === 'password' ? 'fas fa-eye' : 'fas fa-eye-slash';
        });

        document.getElementById('menuToggle').addEventListener('click', function() {
            document.getElementById('navLinks').classList.toggle('active');
        });

        document.getElementById('therapistForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const birthday = document.getElementById('birthday').value;
            const experience = document.getElementById('experience').value;
            const specialization = document.getElementById('specialization').value.trim();
            const hourlyRate = parseInt(document.getElementById('hourlyRate').value);
            const sessionDuration = parseInt(document.getElementById('sessionDuration').value);
            const qualifications = document.getElementById('qualifications').value.trim();
            const bio = document.getElementById('bio').value.trim();
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Validation
            if (!fullName || !email || !phone || !birthday || !experience || !specialization || !hourlyRate || !qualifications || !bio || !password || !confirmPassword) {
                showAlert('Please fill in all required fields', 'error');
                return;
            }

            if (hourlyRate < 200 || hourlyRate > 10000) {
                showAlert('Hourly rate must be between ‚Çπ200 and ‚Çπ10,000', 'error');
                return;
            }

            if (password.length < 8) {
                showAlert('Password must be at least 8 characters', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showAlert('Passwords do not match', 'error');
                return;
            }

            // Age validation (must be 18+)
            const birthDate = new Date(birthday);
            const today = new Date();
            const age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            
            if (age < 18 || (age === 18 && monthDiff < 0)) {
                showAlert('You must be at least 18 years old to apply', 'error');
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            const loadingSpinner = document.getElementById('loadingSpinner');

            submitBtn.disabled = true;
            btnText.style.display = 'none';
            loadingSpinner.style.display = 'inline-block';

            try {
                console.log('üîµ Starting therapist signup...');

                // Step 1: Create auth user
                const { data: authData, error: authError } = await supabaseClient.auth.signUp({
                    email: email,
                    password: password,
                    options: {
                        data: {
                            full_name: fullName,
                            phone: phone,
                            birthday: birthday,
                            role: 'therapist'
                        }
                    }
                });

                if (authError) {
                    console.error('üî¥ Auth error:', authError);
                    throw new Error(authError.message);
                }

                if (!authData.user) {
                    throw new Error('User creation failed - no user returned');
                }

                console.log('üü¢ Auth user created:', authData.user.id);

                // Step 2: Insert into profiles table
                const { error: profileError } = await supabaseClient
                    .from('profiles')
                    .insert({
                        user_id: authData.user.id,
                        email: email,
                        full_name: fullName,
                        phone: phone,
                        birthday: birthday,
                        role: 'therapist',
                        approved: false
                    });

                if (profileError) {
                    console.error('üî¥ Profile creation error:', profileError);
                    throw new Error(`Profile creation failed: ${profileError.message}`);
                }

                console.log('üü¢ Profile created successfully');

                // Step 3: Insert into Therapists table
                const { error: therapistError } = await supabaseClient
                    .from('Therapists')
                    .insert({
                        user_id: authData.user.id,
                        Name: fullName,
                        email: email,
                        phone: phone,
                        Specialization: specialization,
                        bio: bio,
                        qualifications: qualifications,
                        Active: true,
                        approval_status: 'pending',
                        availability: {},
                        hourly_rate: hourlyRate,
                        fee: hourlyRate
                    });

                if (therapistError) {
                    console.error('üî¥ Therapist record error:', therapistError);
                    throw new Error(`Therapist creation failed: ${therapistError.message}`);
                }

                console.log('üü¢ Therapist record created successfully');

                showAlert('‚úÖ Application submitted successfully! Please check your email to verify your account. We will review your application within 24-48 hours.', 'success');

                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 4000);

            } catch (error) {
                console.error('üî¥ Signup error:', error);
                showAlert(error.message || 'Error submitting application. Please try again.', 'error');
            } finally {
                submitBtn.disabled = false;
                btnText.style.display = 'inline';
                loadingSpinner.style.display = 'none';
            }
        });
    </script>
</body>
</html>
